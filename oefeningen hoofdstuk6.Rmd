---
title: "oefeningen hoofdstuk 6 - Analyse op 2 Variabelen"
author: "TijsMartens"
date: "12 april 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# voorbeeld bij 6.2: Het opstellen van een kruistabel


data invoeren en opmaken van de tabel
```{r}
waarderingen_m <- matrix(c(9,8,5,0,8,10,5,4), ncol = 2)

rownames(waarderingen_m) <- c("Goed","Voldoende", "Onvoldoende", "Slecht")
colnames(waarderingen_m)<- c("Man", "Vrouw")
waarderingen <- as.table(waarderingen_m)
```


marginale totalen berekenen
```{r}
margin.table(waarderingen, 1) # rijtotalen
margin.table(waarderingen, 2) # kolomtotalen
margin.table(waarderingen) # aantal waarnemingen (n)
```

percentages van rijen berekene
```{r}
waarderingen_pct <- prop.table(waarderingen, 2)
```

berekenen chi-kwadraat
```{r}
#verwacht <- as.array(margin.table(waarderingen, 1)) %*%t(as.array(margin.table(waarderingen, 2))) / margin.#table(waarderingen)

#afwijking <- (waarderingen - verwacht) ^ 2 / verwacht 

#sum(afwijking)

## ^ is het zelfde als volgende code


summ <- summary(waarderingen)
chi_sq <- summ$statistic

chi_sq
```

berekenen van Cramér's V
```{r}
k <- min(nrow(waarderingen), ncol(waarderingen))
V <- sqrt(chi_sq/margin.table((waarderingen) * (k-1)))
```

maken tabel
```{r}
plot(t(waarderingen))
```

maken geclustere bar chart
```{r}
barplot(waarderingen, beside = TRUE)
```

maken van percentage chart
```{r}
barplot(waarderingen_pct, horiz = TRUE)
```

# oefening 6.1.

_(oefening zelf gemaakt, geen oplossing)_

## opgave

Marktonderzoek toont aan dat achtergrondmuziek in een supermarkt invloed kan hebben op het aankoopgedrag van de klanten. In een onderzoek werden drie methoden met elkaar vergeleken: geen muziek, Franse chansons en Italiaanse hits. Telkens werd het aantal verkochte ???essen Franse, Italiaanse en andere wijnen geteld (Ryan, Northrop-Clewes, Knox & Thurnham, 1998).
De onderzoeksdata bevindt zich in het csv-bestand MuziekWijn.


1. Stel de correcte kruistabel op. Gebruik hiervoor het R-commando table om de frequentietabel te bekomen. 
2. Bepaal de marginalen. 
3. Bepaal de verwachte resultaten. 
4. Bereken manueel de ??2 toetsingsgrootheid. 
5. Bereken manueel de Cramér's V. Wat kan je hieruit besluiten?


## oplossing

inlezezen csv bestand
```{r}


data <- read.csv("C:/Users/tijsm/Google Drive/HoGent 2018-2019/2e semester/Onderzoekstechnieken/files/onderzoekstechnieken-cursus/oefeningen/data/hfst6_2variabelen/MuziekWijn.csv")

data
```

## 1.

```{r}
kruistabel <-table(data)
kruistabel
```

## 2.

```{r}
margin.table(kruistabel, 1)
margin.table(kruistabel, 2)
prop.table(kruistabel)
```

## 3. 

```{r}
#library(gmodels)
#library(lsr)

#crosstable(kruistabel)
```

## 4. 
```{r}
#cramersV(kruistabel)
```


```{r}
chisq.test(kruistabel)
qchisq(0.95, df = 4)
qchisq(1-0.001088, df = 4)

x <- seq(0, 20, length=100)
hx <- dchisq(x, df = 4)
plot(x, hx, type="l")
```

# oefening 6.2.

_(oefening zelf gemaakt, geen oplossing)_

## opgave

Gebruik dezelfde data.

1. Stel de percentages verkochte wijnen voor in een staafdiagram met de muziekconditie= Geen. 2.
Stel de percentages verkochte wijnen voor in een geclusterd staafdiagram (clustered bar chart). 
3. Stel de percentages verkochte wijnen voor in rependiagram (stacked bar chart)
## oplossing

library(vcd)

assocstats(data)

# oefening 6.3.

_(oefening zelf gemaakt, geen oplossing)_

## opgave

Lees het databestand "Aardbevingen.csv" in.

1. Maak een histogram en een boxplot van de variabele "Magnitudes". 
2. Maak een lijngra???ek met het aantal aardbevingen per maand. 
3. Onderzoek of er een verband bestaat tussen de variabelen "Type" en "Source". Bereken ook de Cramér's V-waarde. Wat is de conclusie?

## oplossing

/

# oefening 6.4.

_(oefening zelf gemaakt, geen oplossing)_

## opgave

 * Bepaal handmatig de regressierechte ??0+??1x.
 * Bepaal handmatig de correlatie- en determinatiecoëf???ciënt (R,R2)
 * Geef uitleg bij de gevonden statistieken
## oplossing

## oplossing

## 1. handmatig

```{r}
x <- c(10, 12, 8, 13, 9, 10, 7, 14, 11, 6)
y <- c(11, 14, 9, 13, 9, 9, 8, 14, 10, 6)

mx <- mean(x)
my <- mean(y)

xx <- x - mx
yy <- y - my
beta1 <- sum(xx*yy)/sum(xx^2)
beta0 <- my - beta1 * mx
```


## 2. 

```{r}

plot(x, y)

regr <- lm(y~ x)
abline(regr)

```


## 3. uitleg

hoe dichter de punten bij de lijn ligt hoe beter het verband

## 4. bepaal handmatig r en r kwadraat

bepale r
```{r}
cov(x = x, y = y)
```

pearson's correlatie co

```{r}
rr <- cor (x, y)
rr
```
in het kwadraat

= +- 81% 81% van het gemiddelde wordt betpaald door ??????????????? de rest door toeval

# oefening 6.5.


_(oefening zelf gemaakt, geen oplossing)_

## opgave

Gegeven 6 scatterplots in volgende ???guur en onderstaande correlatiecoëf???ciënten. Match de coëf???ciënten met de scatterplots. Er is dus één scatterplot waarvan geen correlatie gegeven staat hieronder.

## oplossing

# oefening 6.6.

_(oefening zelf gemaakt, geen oplossing)_

## opgave

Lees het databestand "Cats.csv" in.
1. Voer een lineaire regressieanalyse uit op de variabelen Lichaamsgewicht (Bwt, afhankelijke variabele) en Gewicht hart (Hwt, onafhankelijke variabele). 
2. Maak een spreidingsdiagram van beide variabelen. 
3. Bereken en teken de regressielijn. 
4. Bereken de correlatie- en de determinatiecoëf???ciënt. 
5. Geef een interpretatie van deze resultaten.


## oplossing

/

# oefening 6.7.

_(oefening zelf gemaakt, geen oplossing)_

## opgave

1. VoereenlineaireregressieanalyseuitopdevariabelenLichaamsgewicht(Bwt)enGewicht hart (Hwt) per geslacht. 
2. Maak een spreidingsdiagram van beide variabelen voor elk van de geslachten. 
3. Bereken en teken telkens de regressielijn. 
4. Bereken de correlatie- en de determinatiecoëf???ciënt. 
5. Geef een interpretatie aan deze resultaten.


## oplossing




# oefening 6.8.

_(oefening zelf gemaakt, geen oplossing)_

## opgave

 Lees het databestand "Pizza.csv" in.
 
1. Voer een volledige lineaire regressieanalyse uit op de variabelen Rating en CostPerSlice. Trek hieruit de juiste conclusies en ga deze ook gra???sch na. 
2. Onderzoek een mogelijk verband tussen Rating en Neighbourhood. Welke methode kan je hiervoorgebruiken? KanjedegegevensvanRatinghiervoorindezelfdevormgebruiken? 
3. Geef een interpretatie aan deze resultaten. 
4. Stel de kruistabel gra???sch voor met een staafdiagram. Voorzie een legende.


## oplossing

/
